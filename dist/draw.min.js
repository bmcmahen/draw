var point=function(e,t){return{x:e,y:t}},vector=function(e,t){return{u:t.x-e.x,v:t.y-e.y}},angleOf=function(e){var t=Math.atan2(e.v,e.u);return 0>t?2*Math.PI+t:t},distanceBetween=function(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))},circleCenterFromThreePoints=function(e,t,n){return intersect(bisector(e,t),bisector(t,n))},intersect=function(e,t){if(e.a==t.a)return console.error("The two lines are parallel !"),null;if(null==e.a)return{x:e.c,y:t.a*e.c+t.b};if(null==t.a)return{x:t.c,y:e.a*t.c+e.b};var n=(t.b-e.b)/(e.a-t.a);return{x:n,y:e.a*n+e.b}},bisector=function(e,t){var n=midpoint(e,t),r=perpendicular(vector(e,t));if(0==r.u)return{a:null,b:null,c:n.x};var a=r.v/r.u;return{a:a,b:n.y-a*n.x}},midpoint=function(e,t){return{x:(e.x+t.x)/2,y:(e.y+t.y)/2}},perpendicular=function(e){return{u:-e.v,v:e.u}},segment=function(e,t){return{type:"segment",start:e,end:t}},polygon=function(e){return{type:"polygon",points:e}},circle=function(e,t){return{type:"circle",center:e,radius:t}},arc=function(e,t,n){var r=circleCenterFromThreePoints(e,t,n);return{type:"arc",center:r,radius:distanceBetween(e,r),startAngle:angleOf(vector(r,e)),endAngle:angleOf(vector(r,n))}},rectangle=function(e,t){return{type:"rectangle",topLeft:e,bottomRight:t}},draw=function(e,t){switch(e.beginPath(),t.type){case"segment":drawSegment(e,t.start,t.end);break;case"polygon":drawPolygon(e,t.points);break;case"circle":drawCircle(e,t.center,t.radius);break;case"arc":drawArc(e,t.center,t.radius,t.startAngle,t.endAngle);break;case"rectangle":drawRectangle(e,t.topLeft,t.bottomRight)}e.stroke()},drawSegment=function(e,t,n){e.moveTo(t.x,t.y),e.lineTo(n.x,n.y)},drawPolygon=function(e,t){e.moveTo(t[0].x,t[0].y);for(var n=1;n<t.length;)e.lineTo(t[n].x,t[n].y),n++;e.closePath()},drawCircle=function(e,t,n){drawArc(e,t,n,0,2*Math.PI)},drawArc=function(e,t,n,r,a){r=2*Math.PI-r,a=2*Math.PI-a,e.arc(t.x,t.y,n,r,a)},drawRectangle=function(e,t,n){var r=n.x-t.x,a=n.y-t.y;e.strokeRect(t.x,t.y,r,a)};