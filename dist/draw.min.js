var point=function(e,r){return{x:e,y:r}},vector=function(e,r){return{u:r.x-e.x,v:r.y-e.y}},angleOf=function(e){var r=Math.atan2(e.v,e.u);return 0>r?2*Math.PI+r:r},distanceBetween=function(e,r){return Math.sqrt(Math.pow(e.x-r.x,2)+Math.pow(e.y-r.y,2))},circleCenterFromThreePoints=function(e,r,n){return intersect(bisector(e,r),bisector(r,n))},intersect=function(e,r){if(e.a==r.a)return console.error("The two lines are parallel !"),null;if(null==e.a)return{x:e.c,y:r.a*e.c+r.b};if(null==r.a)return{x:r.c,y:e.a*r.c+e.b};var n=(r.b-e.b)/(e.a-r.a);return{x:n,y:e.a*n+e.b}},bisector=function(e,r){var n=midpoint(e,r),t=perpendicular(vector(e,r));if(0==t.u)return{a:null,b:null,c:n.x};var c=t.v/t.u;return{a:c,b:n.y-c*n.x}},midpoint=function(e,r){return{x:(e.x+r.x)/2,y:(e.y+r.y)/2}},perpendicular=function(e){return{u:-e.v,v:e.u}},segment=function(e,r){return{type:"segment",start:e,end:r}},polygon=function(e){return{type:"polygon",points:e}},circle=function(e,r){return{type:"circle",center:e,radius:r}},arc=function(e,r,n){var t=circleCenterFromThreePoints(e,r,n);return{type:"arc",center:t,radius:distanceBetween(e,t),startAngle:angleOf(vector(t,e)),endAngle:angleOf(vector(t,n)),clockerwise:angleOf(vector(t,e))>angleOf(vector(t,r))}},rectangle=function(e,r){return{type:"rectangle",topLeft:e,bottomRight:r}},draw=function(e,r){switch(e.beginPath(),r.type){case"segment":drawSegment(e,r.start,r.end);break;case"polygon":drawPolygon(e,r.points);break;case"circle":drawCircle(e,r.center,r.radius);break;case"arc":drawArc(e,r.center,r.radius,r.startAngle,r.endAngle,r.clockerwise);break;case"rectangle":drawRectangle(e,r.topLeft,r.bottomRight)}e.stroke()},drawSegment=function(e,r,n){e.moveTo(r.x,r.y),e.lineTo(n.x,n.y)},drawPolygon=function(e,r){e.moveTo(r[0].x,r[0].y);for(var n=1;n<r.length;)e.lineTo(r[n].x,r[n].y),n++;e.closePath()},drawCircle=function(e,r,n){drawArc(e,r,n,0,2*Math.PI)},drawArc=function(e,r,n,t,c,a){e.arc(r.x,r.y,n,t,c,a)},drawRectangle=function(e,r,n){var t=n.x-r.x,c=n.y-r.y;e.strokeRect(r.x,r.y,t,c)};